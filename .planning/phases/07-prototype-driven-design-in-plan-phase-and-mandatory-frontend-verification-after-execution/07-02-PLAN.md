---
phase: 07-prototype-driven-design-in-plan-phase-and-mandatory-frontend-verification-after-execution
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/nick-execute-phase/references/agents/nick-executor.md
  - skills/nick-execute-phase/SKILL.md
autonomous: true
has_frontend: false

must_haves:
  truths:
    - "Executor agent reads prototype HTML file before implementing frontend tasks when prototype field exists in plan frontmatter"
    - "Execute-phase orchestrator auto-triggers verify-work skill after all waves when any plan has has_frontend: true"
    - "Auto-verification handles three outcomes: passed (continue), issues_found (present to user), inconclusive (warn and continue)"
    - "Non-frontend phases skip auto-verification entirely with a log message"
    - "Auto-verification runs between wave execution (Step 4) and goal verification (Step 5)"
  artifacts:
    - path: "skills/nick-execute-phase/references/agents/nick-executor.md"
      provides: "Executor agent with prototype-guided execution step"
      contains: "prototype"
    - path: "skills/nick-execute-phase/SKILL.md"
      provides: "Execute-phase orchestrator with Step 4.5 auto-verify frontend"
      contains: "Step 4.5"
  key_links:
    - from: "nick-executor.md load_plan step"
      to: "PLAN.md frontmatter prototype field"
      via: "reads prototype file path from frontmatter"
      pattern: "prototype.*PROTOTYPE\\.html"
    - from: "nick-execute-phase/SKILL.md Step 4.5"
      to: "nick-verify-work/SKILL.md"
      via: "spawns verify-work skill via Task when has_frontend detected"
      pattern: "nick-verify-work/SKILL.md"
---

<objective>
Add prototype-guided execution to the executor agent and auto-triggered frontend verification to the execute-phase orchestrator.

Purpose: The executor reads prototype HTML files as visual specifications before implementing frontend tasks, ensuring implementations match planned layouts. The orchestrator automatically triggers the verify-work skill after all waves complete when any plan in the phase has frontend work, eliminating the need for users to remember manual runtime verification.

Output: Updated nick-executor.md with prototype reading step; updated nick-execute-phase/SKILL.md with Step 4.5 (auto-verify frontend). Both synced to installed locations.
</objective>

<execution_context>
@/Users/nick/.claude/get-shit-done/workflows/execute-plan.md
@/Users/nick/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-prototype-driven-design-in-plan-phase-and-mandatory-frontend-verification-after-execution/07-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add prototype-guided execution to nick-executor.md</name>
  <files>
    skills/nick-execute-phase/references/agents/nick-executor.md
  </files>
  <action>
    Read the current nick-executor.md (repo copy at skills/nick-execute-phase/references/agents/nick-executor.md). Make two additions:

    **Addition 1: Update the `load_plan` step in `<execution_flow>`** -- After the existing line "Parse: frontmatter (phase, plan, type, autonomous, wave, depends_on), objective, context (@-references), tasks with types, verification/success criteria, output spec.", add:

    ```
    **If plan frontmatter has `prototype` field:**
    Read the prototype file at `$PHASE_DIR/{prototype}` to understand the expected visual layout.
    Use the prototype as a design specification:
    - Match the prototype's layout structure (grid, flex, spacing)
    - Follow the prototype's component hierarchy
    - Use placeholder data patterns as guidance for realistic defaults
    - Implement responsive breakpoints shown in the prototype

    The prototype is a GUIDE, not a template:
    - Do NOT copy prototype HTML into JSX (build proper React/framework components)
    - Do NOT modify the prototype file
    - Do NOT use prototype for non-visual aspects (API contracts, state management, data flow)

    In SUMMARY.md, note: "Implemented from prototype: {prototype-file}"
    ```

    **Addition 2: Update `<summary_creation>` section** -- After the existing "If best-practice skills were loaded during execution" block that documents the `skills-loaded` frontmatter, add:

    ```
    If a prototype file was used for visual reference, add to frontmatter:
    ```yaml
    prototype-used: "{phase}-{plan}-PROTOTYPE.html"
    ```
    ```

    Do NOT modify any other sections. Preserve all existing content exactly.
  </action>
  <verify>
    1. `grep "prototype" skills/nick-execute-phase/references/agents/nick-executor.md` -- expect multiple matches covering load_plan step and summary_creation
    2. `grep "PROTOTYPE.html" skills/nick-execute-phase/references/agents/nick-executor.md` -- expect match
    3. `grep "prototype-used" skills/nick-execute-phase/references/agents/nick-executor.md` -- expect match
    4. Existing sections (mcp_protocol, deviation_rules, task_commit_protocol, etc.) are all intact
  </verify>
  <done>nick-executor.md reads prototype HTML as visual spec before frontend tasks and documents prototype usage in SUMMARY.md frontmatter.</done>
</task>

<task type="auto">
  <name>Task 2: Add Step 4.5 auto-verify frontend to nick-execute-phase/SKILL.md and sync both files</name>
  <files>
    skills/nick-execute-phase/SKILL.md
    ~/.claude/skills/nick-execute-phase/SKILL.md
    ~/.claude/skills/nick-execute-phase/references/agents/nick-executor.md
  </files>
  <action>
    **Part A: Update nick-execute-phase/SKILL.md (repo copy)**

    Read the current SKILL.md at skills/nick-execute-phase/SKILL.md. Insert a new Step 4.5 between the existing Step 4 (Execute Waves) section and Step 5 (Verify Phase Goal) section:

    ```markdown
    ## Step 4.5: Auto-Verify Frontend (conditional)

    After all waves complete, check if any executed plan has frontend work:

    ```bash
    HAS_FRONTEND=$(grep -l "has_frontend: true" "$PHASE_DIR"/*-PLAN.md 2>/dev/null | wc -l | tr -d ' ')
    ```

    **If HAS_FRONTEND > 0:**

    Inform user: "Frontend work detected in {HAS_FRONTEND} plan(s). Running runtime verification..."

    Spawn verify-work:

    ```
    Task(
      prompt="First, read ~/.claude/skills/nick-verify-work/SKILL.md for the verification workflow.

      <objective>
      Auto-verify frontend work for phase {phase_number}-{phase_name}.
      Phase directory: {phase_dir}
      </objective>

      <files_to_read>
      - {phase_dir}/*-SUMMARY.md
      - {phase_dir}/*-PLAN.md
      </files_to_read>

      <output>Create {phase_dir}/{padded_phase}-RUNTIME-VERIFICATION.md</output>",
      subagent_type="general-purpose"
    )
    ```

    Handle result from RUNTIME-VERIFICATION.md frontmatter `status`:
    - **passed:** Log "Runtime verification passed." Continue to Step 5.
    - **issues_found:** Display issue summary to user. Ask: "Frontend issues found. Address before proceeding? (yes to halt / no to continue)"
    - **inconclusive:** Log "Runtime verification skipped (Chrome DevTools unavailable or app not running). Consider running `/gsd:verify-work {phase}` manually when ready." Continue to Step 5.

    **If HAS_FRONTEND = 0:**

    Skip. Log: "No frontend plans in this phase. Skipping runtime verification."
    ```

    **Part B: Sync both files to installed location**

    Copy the updated repo files to their installed locations:
    ```bash
    cp skills/nick-execute-phase/SKILL.md ~/.claude/skills/nick-execute-phase/SKILL.md
    cp skills/nick-execute-phase/references/agents/nick-executor.md ~/.claude/skills/nick-execute-phase/references/agents/nick-executor.md
    ```

    Verify sync with diff to confirm repo and installed files are identical.
  </action>
  <verify>
    1. `grep "Step 4.5" skills/nick-execute-phase/SKILL.md` -- expect match
    2. `grep "has_frontend" skills/nick-execute-phase/SKILL.md` -- expect match
    3. `grep "nick-verify-work/SKILL.md" skills/nick-execute-phase/SKILL.md` -- expect match (auto-verify spawns verify-work)
    4. `grep "RUNTIME-VERIFICATION" skills/nick-execute-phase/SKILL.md` -- expect match
    5. `grep "inconclusive" skills/nick-execute-phase/SKILL.md` -- expect match (graceful handling)
    6. `diff skills/nick-execute-phase/SKILL.md ~/.claude/skills/nick-execute-phase/SKILL.md` -- expect no differences
    7. `diff skills/nick-execute-phase/references/agents/nick-executor.md ~/.claude/skills/nick-execute-phase/references/agents/nick-executor.md` -- expect no differences
    8. Step 5 (Verify Phase Goal) and Step 6 (Update Roadmap) still present after Step 4.5
  </verify>
  <done>Execute-phase orchestrator has Step 4.5 that auto-triggers verify-work for frontend phases, handles passed/issues_found/inconclusive outcomes, and skips cleanly for non-frontend phases. Both executor and orchestrator synced to installed locations.</done>
</task>

</tasks>

<verification>
Phase-level checks for Plan 02:
1. `grep "prototype" skills/nick-execute-phase/references/agents/nick-executor.md` shows prototype reading logic
2. `grep "Step 4.5" skills/nick-execute-phase/SKILL.md` shows auto-verify step exists
3. `grep "has_frontend" skills/nick-execute-phase/SKILL.md` shows frontend detection
4. Step ordering preserved: Step 4 -> Step 4.5 -> Step 5 -> Step 6 -> Step 7
5. Both repo files diff-clean against installed copies
6. Existing content in both files is preserved (no accidental deletions)
</verification>

<success_criteria>
- nick-executor.md reads prototype file when plan frontmatter has prototype field
- nick-executor.md documents prototype usage in SUMMARY.md frontmatter
- nick-execute-phase/SKILL.md has Step 4.5 between Step 4 and Step 5
- Step 4.5 detects frontend plans via has_frontend grep
- Step 4.5 spawns verify-work skill and handles three outcomes
- Non-frontend phases skip auto-verification with log message
- Both files synced to ~/.claude/skills/ with identical content
- All existing content in both files preserved
</success_criteria>

<output>
After completion, create `.planning/phases/07-prototype-driven-design-in-plan-phase-and-mandatory-frontend-verification-after-execution/07-02-SUMMARY.md`
</output>
